---
id: apply-agent
title: ブラウザエージェントの適用
description: WebアプリケーションにWhaTap Browser Monitoringエージェントを適用し、ブラウザモニタリングを開始します。
keywords:
  - Browser Monitoring
  - エージェント
---

import TR from '@site/src/components/TR';

WhaTap Browser Monitoringサービスを使用するには、[会員登録](https://www.whatap.io/ja/signup/)後、プロジェクトを作成し、WebアプリケーションにWhaTap Browser Monitoringエージェントを適用する必要があります。

次の動画ガイドを参照してください。

<Youtube ko='gZ5A40G2u2A' en='z0-WMAEQo30' ja='z0-WMAEQo30' />

import Createprojectv2 from "../getting-started/_create-project-v2.mdx";

<Createprojectv2 />

import Accesskey from "../getting-started/_accesskey.mdx";

<Accesskey />

## WhaTap Browser Monitoringエージェントのインストール

エージェントのインストール画面の指示に従って、Webアプリケーションに適用するWhaTap Browser Monitoringエージェントのコードを適用します。

<ImgLang img='rum-apply-agent.png' desc='WhaTap Browser Monitoringエージェントのインストール' />

### ![](/img/number-01.png)データ収集サンプリング

WhaTap Browser Monitoringエージェントは、ユーザーセッションを基準にデータを収集します。 収集する全体セッションの割合を0から100の範囲で設定できます。

### ![](/img/number-02.png)WhaTap Browser Monitoringエージェントスクリプト

WhaTap Browser Monitoringエージェントは、インラインスクリプトの形式で提供します。 インストールガイドで提供するスクリプトコードを、モニタリング対象のすべてのHTML ページの`<head>`タグの先頭に追加してください。

次の2つの方法のいずれかを選択して、エージェントを適用してください。

- **_Async_**(非同期ロード): WebアプリケーションにWhaTap Browser Monitoringエージェントを非同期形式でロードします。 
  - ウェブアプリケーションのロード性能に影響しません。 
  - Browser Monitoringエージェントがロードされる前に発生したAJAX、エラーなどのデータが欠落する可能性があります。
- **_Sync_**(同期ロード): WebアプリケーションにWhaTap Browser Monitoringエージェントを同期形式でロードします。
  - ウェブアプリケーションのロード時にすべてのデータを収集することをお勧めします。 
  - ウェブアプリケーションのロードに影響を与える可能性があります。

## WhaTap Browser Monitoringエージェントのオプション設定 {#setting-agent}

WhaTap Browser Monitoringエージェントに適用するオプションを設定します。 オプションは、インストールスクリプトのConfigオブジェクトで設定できます。 プロジェクトアクセスキー、ユーザーセッション全体の割合、収集から除外リソースドメインなどを設定できます。

```javascript title='config example' showLineNumbers
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  ignoreOrigins: [ 'https://ignore-site.com/' , '/^(https?://)([^/]*)(ignore-site.io)(/)(.*)/i' ],
  collectUserClick: false
}
```

- **projectAccessKey**：プロジェクトアクセスキーです。

- **pcode**：プロジェクトコードです。

- **sampleRate**：収集するユーザーセッションの割合を設定できます。

- **ignoreOrigins**：統計収集から除外する特定のリソースドメインを文字列の配列の形で追加できます。 正規表現を適用することもできます。

- **collectUserClick**：クリックイベントを収集できます。 既定値は`false`です。

:::note

`projectAccessKey`、`pcode`値は、インストールガイドで記載されているスクリプトコードをコピーして使用することをお勧めします。

:::

## 次の段階

- **ユーザー定義イベントを収集する**

  Browser Monitoringを通じてウェブサービスの問題点を把握し、ユーザー体験を改善するために、ウェブページで発生するイベントのうち、開発者と運営者が希望するイベントを追加で収集できるインターフェースを提供します。 ユーザー定義イベントを収集する方法の詳細については、[次の文書](collect-custom-events)を参照してください。

- **実際のユーザーIDを設定する**

  Browser Monitoringでは、実際のユーザーIDやEメールなどでユーザーIDを設定し、データを収集できます。 実際のログインIDに基づいてユーザーセッションの性能とイベントの情報やブラウザーのエラー情報を確認して問題を把握できます。 詳細については、[次の文書](set-real-user-id)を参考にしてください。

- **セッションリプレイを設定する**

  <Cmdname sid="TTL08103" className="uitext" />は、ユーザーがウェブサイトで行うすべてのイベントを記録し、再生できる機能です。 この機能により、クリック、スクロール、入力、ページ切り替えなどのユーザー行動を再現できます。 これにより、ユーザーが実際にウェブサイトとどのように相互作用するかを、正確に把握できます。 詳細については、[次の文書](session-replay)を参照にしてください。

- **モニタリングの開始**

  [WhaTapモニタリングサービス](https://service.whatap.io)ページに移動し、Browser Monitoringを開始します。 先に作成したプロジェクトを選択し<Cmdname sid="side_dashboard" className="uitext" /> &gt; <Cmdname sid="side_rumDashboard" className="uitext" />メニューに移動してください。 モニタリング状況を確認できます。 <Cmdname sid="side_rumDashboard" className="uitext" />メニューの詳細については、[次の文書](dashboard)を参照にしてください。
